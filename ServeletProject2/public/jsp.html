<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<!-- Highlight.js -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<!-- main.js -->
	<script type="text/javascript" src="main.js" defer></script>
	<!-- css -->
	<link rel="stylesheet" href="styles.css">
	<!--fontawesome link for drop navigation bar  -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<title>JSP Turtorial</title>
</head>

<body>
	<div class="topnav" id="myTopnav">
		<a href="index.html" class="active">Home</a>
		<a href="index.html" class="active">Javascript</a>
		<a href="mysql_turtorial.html">MySQL</a>
		<a href="dom.html">DOM</a>
		<a href="java.html">Java</a>
		<a href="jsp.html">JSP</a>
		<a href="servlet.html">Servlet</a>
		<a href="about.html">About</a>
		<a href="javascript:void(0);" class="icon" onclick="myFunction()">
			<i class="fa fa-bars"></i>
		</a>
	</div>
	<form id="language">
		<select name="select">
			<option value="index.html" selected>日本語</option>
			<option value="index-english.html">English</option>
		</select>
	</form>
	<h1> JSP Turtorial</h1>
	<div class="header_image">
	<img src="\pleiades\2022-09\workspace\ServeletProject2\headerIMG.jpg" alt="img"  width="390px"height="320px">
	</div>
	<p>特にわからなかったところ</p>
	<ol>
		<li><a href="https://qiita.com/takahirocook/items/70f9b5bca1da89474b9d">【Java】Webスコープ(データの有効範囲)</a></li>
		<li><a href="https://www.ntt.com/bizon/glossary/j-s/session.html">セッション</a></li>
		<li><a href="#">C</a></li>
		<li><a href="#">D</a></li>
		<li><a href="#">E</a></li>
	</ol>
	<h3>ディレクティブ</h3>
	<p>@pageで文字エンコーディングを指定すること</p>
	<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">ディレクティブ</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">@page</th>
<td id="null">現在のページの処理方法を指定</td>
</tr><tr>
<th id="null">@include</th>
<td id="null">外部ファイルをインクルード（「アクションタグ」参照）起動時にだけファイルが埋め込まれる。</td>
</tr><tr>
<th id="null">@taglib</th>
<td id="null">タグライブラリを定義</td>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
	
<h3>アクションタグ</h3>

	<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">アクションタグ</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">include</th>
<td id="null">指定した外部ファイルを埋め込む。JSP実行後もファイルを埋め込むことができる。</td>
</tr><tr>
<th id="null">forward</th>
<td id="null">受信したリクエスト情報をほかのJSPやServletに転送する。URLは転送元のまま。</td>
</tr><tr>
<th id="null">useBean</th>
<td id="null">JSPページ内でJavaBeansクラスのオブジェクトを生成する。</td>
</tr><tr>
<th id="null">setProperty</th>
<td id="null">JavaBeansのクラスのプロパティ値（メンバ変数の値）を設定する。</td>
</tr><tr>
<th id="null">getProperty</th>
<td id="null">JavaBeansのクラスのプロパティ値（メンバ変数の値）を設定する。</td>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
	<h3>setCharacterEncodingで文字コード形式を指定</h3>
	<pre>
	<code>
&lt;%@ page contentType="text/html"; charset="UTF-8" %>
	</code>
	</pre>
<p><strong>単一のクラスをインポートする場合</strong></h3>
<pre>
	<code>
&lt;%@ page import="java.utill.Arraylist" %>
	</code>
	</pre>
	<h3>includeを使ってほかのページからコピー</h3>
	<pre>
	<code>
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset="UTF-8">
&lt;title>Insert title here&lt;/title>
&lt;/head>
&lt;body>
&lt;jsp:include page = "myheader.html"/>
&lt;h1>Hello World&lt;/h1>
&lt;jsp:include page="footer.jsp"/>
&lt;/body>
&lt;/html>


//footer.jsp
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset="UTF-8">
&lt;title>Insert title here&lt;/title>
&lt;/head>
&lt;body>
&lt;footer>
  &lt;p>Author: Hege Refsnes&lt;/p>
  &lt;p>&lt;a href="mailto:hege@example.com">hege@example.com&lt;/a>&lt;/p>
&lt;/footer>
&lt;/body>
&lt;/html>


//myheader.html htmlからもインクルードできる。
&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset="UTF-8">
&lt;title>Insert title here&lt;/title>
&lt;/head>
&lt;body>
&lt;h1>JSP turtorial this is from the html.&lt;/h1>
&lt;/body>
&lt;/html>
	</code>
	</pre>
	<h3>スクリプトレット &lt;%= %></h3>
	<p>Javaの式をここに書けるようになる。</p>
	<pre>
	<code>
&lt;% int x = 10, y = 20 ;%>
&lt;% int z  = x + y %>

&lt;% for (int i=0; i&lt;5; i++)%>
こんにちわ
&lt;% }%>

そのほかにも

	</code>
	</pre>
<div class="table">
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">コード</th>
<th id="null">説明</th>
</tr></thead><tbody><tr>
<th id="null">&lt;%= abc %></th>
<td id="null">変数abcの値を表示します。</td>
</tr><tr>
<th id="null">&lt;%= getValue( ) %></th>
<td id="null">メソッドgetValueの実行結果を表示します。</td>
</tr><tr>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
</div>

<h3>JavaファイルからJSPにメソッドを呼び込む</h3>
<p>JavaでつくったメソッドをJSPに表示する方法。</p>
<pre>
<code>
//パッケージfunのクラス名FunUtils.java
package funny;

public class FunUtils {
	public static String makeItLower(String data) {
		return data.toLowerCase();
	}
}


//fun-test.jsp
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset=&lt;"UTF-8">
&lt;title>Insert title here &lt;/title>
&lt;/head>
&lt;body>
have some fun &lt;%= funny.FunUtils.makeItLower("HAHAHAHAHA") %>
&lt;/body>
&lt;/html>

</code>
</pre>
 <h3>JSPファイルでリクエストパラメーターの値を取得する方法</h3>
	<p>formでname＝"name" name="gender"と指定した場合</p>
	<pre>
	<code>
&lt;% 
request.setCharacterEncoding("UTF-8");
String name = request.getParameter("name");
String gender = request.getParameter("gender")
%>
	</code>
	</pre>
<h3>フォーム作り方(JSPだけ)</h3>
<p>JSPだけでフォームを作ります。こちらはEL式を使っていますのでリクエストパラメータを取得する必要はない。この場合${param.}を使う。</p>
<pre>
<code>
//students-form.html

&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset="UTF-8">
&lt;title>Insert title here&lt;/title>
&lt;/head>
&lt;body>
&lt;form action="students-response.jsp">
&lt;First Name : &lt;input type="text" name="firstName">&lt;br>
&lt;Last Name : &lt;input type="text" name="lastName">&lt;br>

&lt;select name="country">&lt;br>
	&lt;option>Brazil&lt;/option>
	&lt;option>France&lt;/option>
	&lt;option>Germany&lt;/option>
	&lt;option>Japan&lt;/option>
&lt;/select>&lt;br>

Java&lt;input type="radio" name="favoriteLanguage" value="Java">
Javascript&lt;input type="radio" name="favoriteLanguage" value="Javascript">
PHP&lt;input type="radio" name="favoriteLanguage" value="PHP">
Python&lt;input type="radio" name="favoriteLanguage" value="Python">
Ruby&lt;input type="radio" name="favoriteLanguage" value="Ruby">


Java&lt;input type="checkbox" name="favoriteLanguageCheck" value="Java">
Javascript&lt;input type="checkbox" name="favoriteLanguageCheck" value="Javascript">
PHP&lt;input type="checkbox" name="favoriteLanguageCheck" value="PHP">
Python&lt;input type="checkbox" name="favoriteLanguageCheck" value="Python">
Ruby&lt;input type="checkbox" name="favoriteLanguageCheck" value="Ruby">&lt;br>


&lt;input type="submit" name="submit">&lt;br>
&lt;/form>
&lt;/body>
&lt;/html>

//students-response.jsp

&lt;%@ page language="java" contentType="text/html; charset=UTF-8"pageEncoding="UTF-8"%>
&lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;meta charset="UTF-8">
&lt;title>Insert title here&lt;/title>

&lt;/head>&lt;
&lt;body>
	&lt;p>style="color:red">Here is your result.&lt;/p>&lt;br> 
	First Name : ${param.firstName } &lt;br>
	Last Name :  ${param.lastName } &lt;br>
	Your country: ${param.country} &lt;br>
		Your favorite Language : 
	&lt;%
	String[] langs = request.getParameterValues("favoriteLanguageCheck"); 
	
	for(String tempLang :langs){
		out.println("&lt;li>" + tempLang +"&lt;/li>");
	}
	%>
	
&lt;/body>
&lt;/html>
</code>
</pre>

 <h3>MVCモデル</h3>
 <p>MVCモデルを用いてウェブアプリケーションを作成するのが一般的です。MVCモデルを実装するとJSPファイルをwebで直接呼ぶとエラーの原因になります。ですので、
 一般的にはサーブレットからJSPを呼ぶようにしてください。ファイル位置はWebContent直下にJSPファイルを作りそこに配置するのが基本です。</p>
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead>
<tr>
<th id="null" width="30%">要素</th>
<th id="null">役割</th>
</tr>
</thead>
<tbody>
<tr>
<th id="null">モデル MODEL</th>
<td id="null">アプリケーションのデータ処理をJavaでする。</td>
</tr><tr>
<th id="null">ビュー VIEW</th>
<td id="null">がめんのひょうじを基本JSPで行う。JSPからデータをServlet、Javaに送ったりする。</td>
</tr><tr>
<th id="null">コントローラー COTOLOLLER</th>
<td id="null">ユーザーから要求をもらったり、飛ばしたり、いろんな処理をサーブレットでする。</td>
</tr>
</tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
<h3>フォーワード</h3>
<p>ServletからJSPページを表示させるやり方の一つ。</p>
	<pre>
	<code>
RequestDispatcher dispatcher = request.getRequestDispatcher("Path");
dispatcher.forward(request, response);
	</code>
	</pre>
<p>JSPファイルの場合　→/WebContentからのパス</p> 
<p>Servletファイルの場合　→/URLパターン</p> 
<h3>リダイレクト</h3>
<p>フォーワードとサーブレットは処理の仕方が違うフォーワードはリクエストレスポンスを一往復するのに対して、リダイレクトh２往復する。
転送元と転送先のアプリケーションが別の場合はリダイレクトを使うしかないです。リダイレクトはブラウザにサイトリクエストする。そのため、アドレスばーも変わる。</p>
	<pre>
	<code>
response.sendRedirect("/example/SampleServlet");
response.sendRedirect("URL PATH");
	</code>
	</pre>
<p>JSPファイルの場合　→/WebContentからのパス</p> 
<p>Servletファイルの場合　→/URLパターン</p> 

<h3>スコープ基本</h3>
<p>JSPからServletを使うとインスタンスがどこへ行ってしまったのか、通常JSP同士ならば何事もなかったかのように動いていたものがサーブレットを通すことでインスタンスが消えてしまうことがある。
このようなときには、<strong>スコープ</strong>を使うのが基本である。それはインスタンスを保存する場所である。スコープにより、サーブレットクラスとJSPファイル間をインスタンスは通ることができるようになる。</p>
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">スコープ名</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">page</th>
<td id="null">同一のJSPファイル内で情報を共有する。</td>
</tr><tr>
<th id="null">request</th>
<td id="null">ユーザ（ｗｅｂブラウザ）から送信された一回のリクエスト内で情報を共有する。</td>
</tr><tr>
<th id="null">session</th>
<td id="null">ユーザ（ｗｅｂブラウザ）別に、複数のリクエストをまたいで、情報を共有する。</td>
</tr><tr>
<th id="null">application</th>
<td id="null">ウェブアプリケーション内で、情報を共有する</td>
</tr><tr>
<th id="null"> void setAttribute(String name, Object o)　</th>
<td id="null">オブジェクトに第一引数で指定したキー名で第二引数のデータを格納する。</td>
</tr><tr>
<th id="null">Object getAttribute(String name)</th>
<td id="null">オブジェクトから引数に指定した名前のキーに相当するデータを取得する。＊キー名に相当するデータが存在しない場合はNullを返す。</td>
</tr><tr>
<th id="null">void  removeAttribbtue(String name)</th>
<td id="null">オブジェクトから引数に指定した名前のキーに相当するデータを消去する。</td>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
<h3>スコープ関連のメソッド</h3>
<p>アプリケーションスコープ、セッションスコープ、リクエストスコープのデータ共有に使用するメソッドはsetAttribute() （データ格納用メソッド）getAttribute（データ取得用メソッド） removeAttributeです。（データ消去用メソッド）</p>
<h3>インスタンス保存方法 JavaBeans</h3>
<p>このインスタンスを保存する方法がJavaBeansクラスをつくることである。これがJavaBeansだ。</p>
<pre>
<code>
//パッケージはモデル。
package model;

import java.io.Serializable;

//必ずpublic
public class Human implements Serializable {
//フィールド変数はprivate　
//外部からはメソッドのアクセスだけにする。
private String name;
private int age;

public Human() {
}

public Human(String name, int age) {
	this.name = name;
	this.age = age;

}

//ゲッター
//gettersetterメソッドを持たせる。
//getterはgetから始める。
//booleanの場合はisから始める。
//引数はなし。戻り値はフィールド。
//セッター
//setterはsetから始める。
//引数は一つでフィールドに設定する用。戻り値なし。

public String getName() {
	return name;
}

public void setName(String name) {
	this.name = name;
}

public int getAge() {
	return age;
}

public void setAge(int age) {
	this.age = age;
}

}

</code>
</pre>
<h3>アプリケーションスコープ　セッションスコープ　リクエストスコープ</h3>
<p><a href="https://qiita.com/takahirocook/items/70f9b5bca1da89474b9d">こちらを参照にしました。</a></p>
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead>
<tr>
<th id="null" width="30%">スコープ名</th>
<th id="null">内容</th>
<th id="null">クラス名</th>
</tr>
</thead>
<tbody>
<tr>
<th id="null">アプリケーションスコープ(application)</th>
<td id="null">Webアプリケーション自体を指し、最も広い有効範囲を示します。
アプリケーション・サーバーが終了しない限り保持されるスコープ。
ブラウザを閉じても保持されます。</td>
<td id="null">ServletContext</td>
</tr>
<tr>
<th id="null">セッションスコープ
<p><a href="https://www.ntt.com/bizon/glossary/j-s/session.html">セッション</a>はありとあらゆるアプリに使われている。それぞれのユーザーは独自のセッションを持ってる。</p>
(session)</th>
<td id="null">ある特定のWebクライアントとWebサーバの通信を1つの単位として扱い、
その通信が閉ざされるまでの間を有効範囲とします。
ブラウザを閉じない、あるいはタイムアウトしない限り保持されます。</td>
<td id="null">HttpSession</td>
</tr>
<tr>
<th id="null">リクエストスコープ
(request)</th>
<td id="null">クライアント（ブラウザ）から1回のリクエストの間だけを有効範囲とします。
ブラウザからのリクエスト毎に生成されます。
次のリクエストが来た場合やブラウザを閉じたり、
アプリケーション・サーバーが再起動した場合は原則保持されません</td>
<td id="null">HttpServletRequest</td>
</tr>
</tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
<h3>EL式 ${式}</h3>
<pre>
<code>
計算結果の出力方法
${100+200} //expected 300

比較結果の出力方法
${data > 10} expected true/false

1. 例題　
スコープに保存されているオブジェクトを参照する、
session.setAttribute("name", "Yamada Taro");

${name} or ${sessionScope.name}

2.例題
スコープに保存されているオブジェクトを参照する、
Product p = new Product();
p.setName("Apple");
session.setAttribute("product", p);

${product.name} or ${sessionScope.name} //expected Apple

3. 例題3
スコープに保存されているオブジェクトを参照する、
String[] fruits = {"Apple", "Strawberry", "Banana"};
session.setAttribute("list", fruits);

${list[0]} or ${sessionScope.list[0]} // expected Apple


</code>
</pre>
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead>
<tr>
<th id="null" width="30%">スコープ名</th>
<th id="null">EL式での記述方法</th>
</tr>
</thead>
<tbody>
<tr>
<th id="null">page</th>
<td id="null">pageScope</td>
</tr>
<tr>
<th id="null">request</th>
<td id="null">requestScope</td>
</tr>
<tr>
<th id="null">session</th>
<td id="null">sessionScope</td>
</tr>
<tr>
<th id="null">application</th>
<td id="null">applicationScope</td>
</tr>
</tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
<h3>Jsp:useBean </h3>
<p>useBeanをつかってオブジェクトと名前を生成する。ラムダ式で受けとる。</p>
<pre>
<code>
jsp:useBean id="product" scope="session" class="bean.Product" 
jsp:setProperty name="product" property="name" value="りんご"
jsp:setProperty name="product" property="price" value="200" 

上記は下記と同じ。
&lt;%

Product p = new Product();
p.setName("Apple");
p.setPrice(200);

session.setAttribute("product", p);
%>


// ここで受け取る。
商品名：${sessionScope.product.name}　
単価：${product.price}
</code>
</pre>
<h3>JSTLのタグの種類</h3>
<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">JSTL名</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">core</th>
<td id="null">繰り返し、条件分岐、変数の参照設定などの基本タグ。</td>
</tr><tr>
<th id="null">il8n</th>
<td id="null">数値や日付のフォーマット、国際対応可機能のサポート。</td>
</tr><tr>
<th id="null">xml</th>
<td id="null">XML文章の解析、XSLスタイルシートを変換する。</td>
</tr><tr>
<th id="null">function</th>
<td id="null"> 文字列などを操作する、</td>
</tr><tr>
<th id="null">datasbase</th>
<td id="null">SQLを発行しデータベースを操作する。</td>
</tr><tr>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>

</body>
</html>