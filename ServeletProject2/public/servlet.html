<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<!-- Highlight.js -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<!-- main.js -->
	<script type="text/javascript" src="main.js" defer></script>
	<!-- css -->
	<link rel="stylesheet" href="styles.css">
	<!--fontawesome link for drop navigation bar  -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<title>Servlet Turtorial</title>
</head>
<body>
	<div class="topnav" id="myTopnav">
		<a href="index.html" class="active">Home</a>
		<a href="index.html" class="active">Javascript</a>
		<a href="mysql_turtorial.html">MySQL</a>
		<a href="dom.html">DOM</a>
		<a href="java.html">Java</a>
		<a href="jsp.html">JSP</a>
		<a href="servlet.html">Servlet</a>
		<a href="about.html">About</a>
		<a href="javascript:void(0);" class="icon" onclick="myFunction()">
			<i class="fa fa-bars"></i>
		</a>
	</div>
	<form id="language">
		<select name="select">
			<option value="index.html" selected>日本語</option>
			<option value="index-english.html">English</option>
		</select>
	</form>
	<h1> Servlet Turtorial</h1>
	<div class="header_image">
	<img src="\pleiades\2022-09\workspace\ServeletProject2\headerIMG.jpg" alt="img"  width="390px"height="320px">
	</div>
	<p>特にわからなかったところ</p>
	<ol>
		<li><a href="#">A</a></li>
		<li><a href="#">B</a></li>
		<li><a href="#">C</a></li>
		<li><a href="#">D</a></li>
		<li><a href="#">E</a></li>
	</ol>
<body>
<h4>Web.xmlに設定可能な主な内容</h4>
<ul>
<li>Servletの定義　：　作成したServletに対して、クラスメイトは別にServlet名をつけて定義する。</li>
<li>Servletパスの定義　：　定義したServlet名に対して、Servletパスを定義する。</li>
<li>フィルタの定義　：　Servletを呼び出すときに自動的に呼び出すプログラムの定義する。</li>
<li>セッションタイムアウトの定義　：　定義した時間内にリクエストがない場合、セッションを切断する。</li>
</ul>

<img src="\pleiades\2022-09\workspace\ServeletProject2\servlet01.jpg" alt="img"  width="390px"
		height="320px">
<pre>
<code>
&lt;servlet>
    &lt;description>&lt;/description>
    &lt;display-name>ServletSample05&lt;/display-name>
    &lt;servlet-name>ServletSample05&lt;/servlet-name>
    &lt;servlet-class>chap07.ServletSample05&lt;/servlet-class>
  &lt;/servlet>
  &lt;servlet-mapping>
   &lt;servlet-name>ServletSample05&lt;/servlet-name>
    &lt;url-pattern>/servletsample05&lt;/url-pattern>
  &lt;/servlet-mapping>
</code>
</pre>

<h4>HttpServletRequestインターフェイス</h4>
	<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">メソッド</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">setCharacterEncoding::: void setCharacterEncoding(String env)</th>
<td id="null">パラメーターの文字コードを設定する</td>
</tr><tr>
<th id="null">void setAttrivute (String name, Object o)</th>
<td id="null">リクエストに属性を設定する。</td>
</tr><tr>
<th id="null">String getAttribute(String name)</th>
<td id="null">リクエストパラメータの値を取得する。</td>
</tr><tr>
<th id="null">String[] getParameterValues(String name)</th>
<td id="null">指定された名前のリクエストパラメーターのすべての値を取得する。</td>
</tr><tr>
<th id="null">HttpSession getSession(bookean create)</th>
<td id="null">新規あるいは既存のセッションオブジェクトを取得する、</td>
</tr><tr>
<th id="null">get RequestDispatcher (String path)</th>
<td id="null">RequestDispatcher インターフェイスのオブジェクトを生成する。</td>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
 
 
	<table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">メソッド</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">String get ServerName()</th>
<td id="null">サーバー名を取得する。</td>
</tr><tr>
<th id="null">int getServerPort()</th>
<td id="null">サーバーのポート番号を取得する。</td>
</tr><tr>
<th id="null">String getMethod()</th>
<td id="null">「GET」か「POST」を取得する。</td>
</tr><tr>
<th id="null">String getRequestURL()</th>
<td id="null">URLのコンテキストルートからのパスを取得する。</td>
</tr><tr>
<th id="null">String getContextPath()</th>
<td id="null">URLのコンテキスト名を取得する。</td>
</tr><tr>
<th id="null">String getServletPath()</th>
<td id="null">URLのServletのパス名を取得する。</td>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
 <h4>サーブレクとくらすの定義</h4>
 <ul>
 <li>HttpServletクラスを継承しユーザ定義Servletクラスを定義する。</li>
 <li>必要に応じてdoGet() doPost()をオーバーライドしてHTTP通信の対応処理をする。</li>
 </ul>
 <pre>
<code>

public class XYZ extends HttpServlet {
	protected void doGet(HttpRequest req, HttpServletResponse res) 
	throws ServletException, IOException {
		//getリクエスト送信時の処理。
	}
	protected void doPost(HttpRequest req, HttpServletResponse res) 
	throws ServletException, IOException {
		//POSTリクエスト送信時の処理。
}
}
</code>
</pre>
 <h4>HttpServletResponseインターフェイス</h4>
 <table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">メソッド</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">SC_INTERNAL_SERVER_ERROR</th>
<td id="null">リクエストの完了を妨げるようなHTTPサーバーの内部エラーを示すステータスコード５００</td>
</tr><tr>
<th id="null">void setContentType(String type)</th>
<td id="null">webブラウザに渡すコンテンツタイプを設定する。</td>
</tr><tr>
<th id="null">PrintWriter getWriter()</th>
<td id="null">出力ストリームを取得する。</td>
</tr><tr>
<th id="null">void sendError(int sc)</th>
<td id="null">引数に設定されたステータスを使ってウェブブラウザにエラーレスポンスを送る。</td>
</tr><tr>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>
<h4>setContetntType() コンテンツタイプ設定する。</h4>
<pre>
<code>
public class XYZ extends HttpServlet {
	protected void doGet(HttpRequest req, HttpServletResponse res) 
	throws ServletException, IOException {
//Webブラウザにどのようなタイプのデータを
送るかのお知らせをするための情報
							↓MIMEタイプ	↓文字コード
		res.setContentType("text/html;charset="UTF-8");
	}
}
</code>
</pre>

<h4>getWriter() 出力ストリームを取得する。</h4>
<pre>
<code>
public class XYZ extends HttpServlet {
	protected void doGet(HttpRequest req, HttpServletResponse res) 
	throws ServletException, IOException {

		res.setContentType("text/html;charset="UTF-8");
		//webブラウザに情報を送るための道を作成する。
		PrintWriter out = res.getWriter();
		
		//htmlコードを書いていく。
		out.println("");
		
	}
}
</code>
</pre>
<h4>フォームのリクエストインスタンスをgetParameterで保存する。</h4>
<pre>
<code>
protected void doPost(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
//HTMLで設定したメタタグとおなじになるように設定してください。
req.setCharacterEncoding("UTF-8");
//この部分はHTMLから送られてきたデータを取得する。
String name = req.getParameter("name");
String gender = req.getParameter("gender");

res.setContentType("text/html; charset=UTF-8");

//htmlコードを書いていく。
		out.println("");

</code>
</pre>
<h4>初期化パラメータ</h4>
<p>ＤＢ接続する際のログインやＩＤやパスワードや、使用する外部ファイル名などをあらかじめ設定しておいて実行時によみこんで利用できるようにすること。</p>
<p>設定情報（web.xml）をＳｅｒｖｌｅｔに保存する。利用する情報をあらかじめ設定しておくことで読み込むだけだから、毎回プログラムを書かなくてもいいし覚える必要もない。また万が一パスワードやユーザー名に変更があった場合開発者が各々変更することはない。weeb.xmlだけを変更すればよい。最後に開発者がパスワードを記憶しなくてもよい。</p>
<pre>
<code>
&lt;servlet>

&lt;servlet-name>servlet名&lt;/servlet-name>
&lt;servlet-class>&lt;/servlet-class>
&lt;init-param>
&lt;param-name>パラメータ名　例→　DATA&lt;/param-name>
&lt;param-vaalue>パラメータ値　例→　1000&lt;/param-value>
&lt;/init-param>

&lt;/servlet>

</code>
</pre>
<h4>ServletからSevlet初期化パラメータを取得する方法</h4>
<p>ServletConfigオブジェクトを取得する。</p>
<pre>
<code>
Servlet config = getServletConfig();
</code>
</pre>
<p>パラメータ名を指定してパラメータ値を取得する。</p>
<pre>
<code>
Servlet param = config.getInitParameter("パラメータ名")
</code>
</pre>

<h4>コンテスト初期化パラメーターをしゅとくする方法</h4>
<p>コンテキスト単位に指定する初期化パラメータ。プロジェクト単位でせっていするからほかのServletでも利用可能。</p>
<pre>
<code>
&lt;web-app>
&lt;context-param>
&lt;param-name>パラメータ名例→　 DATA&lt;/param-name>
&lt;param-value>パラメータ値 例→　2000&lt;/param-value>
&lt;/context-param>
&lt;/web-app>
</code>
</pre>

<ol>
<li>ServletConfigオブジェクトを取得する。</li>
<pre>
<code>
Servlet config = getServletConfig();
</code>
</pre>
<li>ServletContextオブジェクトを取得する。</li>
<pre>
<code>
ServletContext context = config.getServletContext();
</code>
</pre>
<li>パラメータ名を指定してパラメータ値を取得する。</li>
<pre>
<code>
String param = context.getInitParameter("パラメータ名");
</code>
</pre>
</ol>

<h4>フィルタ　</h4>
<p>Servletを実行する前に先に呼び出される。フィルタはServletやJSPや静的コンテンツなどを呼び出すときに自動的に先に呼び出されるプログラムです。フィルタの設定ができることで必要な機能を
持ったフィルタをさくせいして設定しておけばServlet自体はへんこうすることなく、呼び出し元もきにすることなく様々な前処理が可能となります。</p>
<pre>
<code>
public class XYZ implements Filter {
	.....
}
</code>
</pre>
 <table id="tbl75c" class="cmsTable cmsTableC cmsTable75">
<caption></caption>
<thead><tr>
<th id="null" width="30%">メソッド</th>
<th id="null">概要</th>
</tr></thead><tbody><tr>
<th id="null">init</th>
<td id="null">フィルタが使用されるときに呼びだされる。public void init(FilterConfig filterConfig)throws ServletException</td>
</tr><tr>
<th id="null">doFilter</th>
<td id="null">フィルタの対象となるServletなどが呼び出される時に実行される。 public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws Java.io.IOException, ServletException</td>
</tr><tr>
<th id="null">destory()</th>
<td id="null">フィルタが破棄されるときに呼び出される</td>
</tr><tr>
</tr></tbody>
<tfoot><tr><td colspan="2"></td></tr></tfoot>
</table>

<pre>
<code>

フィルタの定義方法
&lt;filter>
&lt;filter-name>フィルタ名&lt;/filter-name>
&lt;filter-class>フィルタのクラス名&lt;/filter-class>
&lt;/filter>

フィルタ処理後のパスの定義方法
&lt;filter-mapping>
&lt;filter-name>フィルタ名&lt;/filter-name>
&lt;url-patter>フィルタのクラス名&lt;/url-patter>
&lt;/filter-mapping>
</code>
</pre>
<pre>
<code>
  &lt;servlet>
   &lt;description>&lt;/description>
    &lt;display-name>ServletSample06&lt;/display-name>
    &lt;servlet-name>ServletSample06&lt;/servlet-name>
    &lt;servlet-class>chap07.ServletSample06&lt;/servlet-class>
 &lt;/servlet>
  &lt;servlet-mapping>
    &lt;servlet-name>ServletSample06&lt;/servlet-name>
    &lt;url-pattern>/servletsample06&lt;/url-pattern>
  &lt;/servlet-mapping>
  &lt;filter>
    &lt;display-name>FilterSample&lt;/display-name>
    &lt;filter-name>FilterSample&lt;/filter-name>
    &lt;filter-class>chap07.FilterSample&lt;/filter-class>
  &lt;/filter>
 &lt;filter-mapping>
    &lt;filter-name>FilterSample&lt;/filter-name>
    &lt;url-pattern>/servletsample06&lt;/url-pattern>
  &lt;/filter-mapping>
 </code>
</pre>
</body>
</html>